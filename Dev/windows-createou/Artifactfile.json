{
    "$schema": "https://raw.githubusercontent.com/Azure/azure-devtestlab/master/schemas/2016-11-28/dtlArtifacts.json",
    "title": "Create Organizational Unit in AD DS",
    "publisher": "Microsoft",
    "description": "Creates a custom OU to use with the domain join artifact.",
    "tags": [
        "Windows",
    ],
    "iconUri": "https://raw.githubusercontent.com/jeffgilb/devtestlabs/master/Dev/jeff.png",
    "targetOsType": "Windows",
    "parameters": {
#        "OUPath": {
#            "type": "string",
#            "displayName": "Organizational Unit LDAP Path",
#            "description": "LDAP path to where you want to create the new OU (leave blank for root)."
#        },
        "OUName": {
            "type": "string",
            "displayName": "Organizational Unit Name",
            "description": "Name for the new OU. "
        }
        "OUDescription": {
            "type": "string",
            "displayName": "Organizational Unit Description",
            "description": "Description for the new OU. "
        }
    },
    "runCommand": {
        #"commandToExecute": "[concat('powershell.exe -ExecutionPolicy bypass \"& ./startChocolatey.ps1 -PackageList ', 'CreateOU', ' -UserName ', parameters('installUsername'), ' -Password ', parameters('installPassword'), '\"')]"
	# New-ADOrganizationalUnit -Name Vendors -Path "OU=Employees,DC=Globomantics,DC=Local" -Description "Temporary vendor accounts" -PassThru
	"commandToExecute": "[concat('powershell.exe -ExecutionPolicy bypass -File createOU.ps1', ' -OUName ', replace(parameters('OUName'), ' ', '_'), ' -OUDescription ', parameters('OUDescription'))]"

    }
}